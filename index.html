<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic Tac Toe</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <style>
        .block {
            background-color: black;
            width: 200px;
            height: 200px;
            cursor: pointer;
            text-align: center;
        }

        .block:nth-child(1) {
            border-right: 1px solid yellow;
            border-bottom: 1px solid yellow;
        }

        .block:nth-child(2) {
            border-bottom: 1px solid yellow;
        }

        .block:nth-child(3) {
            border-left: 1px solid yellow;
            border-bottom: 1px solid yellow;
        }

        .board {
            width: 100%;
            position: absolute;
            left: 30%;
            top: 10%;
            z-index:2;
        }

        img {
            width: 100px;
            height: 100px;
            position: relative;
            top: 18%;
        }
        #canvas{
            position: absolute;
            left: 30%;
            top: 10%;
            z-index:1;
        }
        .row{
            margin-left: 0;
            margin-right:0 ;
            width:600px;
        }
    </style>
</head>

<body>
    <center>
        <h3 id="player">Player 1 Turn</h3>
    </center>
    <div class="board">
        <div class="row">
            <div class="block" onclick="show(0,0,0)"></div>
            <div class="block" onclick="show(1,0,1)"></div>
            <div class="block" onclick="show(2,0,2)"></div>
        </div>
        <div class="row">
            <div class="block" onclick="show(0,1,3)"></div>
            <div class="block" onclick="show(1,1,4)"></div>
            <div class="block" onclick="show(2,1,5)"></div>
        </div>
        <div class="row">
            <div class="block" onclick="show(0,2,6)"></div>
            <div class="block" onclick="show(1,2,7)"></div>
            <div class="block" onclick="show(2,2,8)"></div>
        </div>
    </div>
    <canvas id="canvas" width="600" height="600"></canvas>
    <div style="position: absolute;bottom:10px;width:100%;">
        <center>Icons made by <a
            href="https://www.flaticon.com/authors/smashicons" title="Smashicons">Smashicons</a> from <a
            href="https://www.flaticon.com/" title="Flaticon"> www.flaticon.com</a><br>
            &copy;Vaibhav Shukla</center>
    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
    </script>
    <script>
        var canvas=document.getElementById("canvas");
        var ctx=canvas.getContext("2d");
        var turn = 1,
            avatar = "066-Spiderman.png",
            flag = [[{status:0,avatar:0}, {status:0,avatar:0}, {status:0,avatar:0}],[{status:0,avatar:0},{status:0,avatar:0},{status:0,avatar:0}], [{status:0,avatar:0},{status:0,avatar:0},{status:0,avatar:0}]];

        const allEqual = arr => arr.every( v => ((v === arr[0])&&(v!==0)) )

        function checkMove(x,y,turn){
            var temp=[],valid=0;
            if(y==x)
            temp.push({line:"y=x",success:0,x1:0,y1:0,x2:600,y2:600});
            if(x==0)
            temp.push({line:"x=0",success:0,x1:100,y1:0,x2:100,y2:600});
            if(x==1)
            temp.push({line:"x=1",success:0,x1:300,y1:0,x2:300,y2:600});
            if(x==2)
            temp.push({line:"x=2",success:0,x1:500,y1:0,x2:500,y2:600});
            if(y==0)
            temp.push({line:"y=0",success:0,x1:0,y1:100,x2:600,y2:100});
            if(y==1)
            temp.push({line:"y=1",success:0,x1:0,y1:300,x2:600,y2:300});
            if(y==2)
            temp.push({line:"y=2",success:0,x1:0,y1:500,x2:600,y2:500});
            if(y==-x+2)
            temp.push({line:"y=-x+2",success:0,x1:600,y1:0,x2:0,y2:600});
            console.log(temp);
            temp.forEach(element=>{
                var tempFlag=[];
                for(i=0;i<3;i++){
                    if(element.line=="y=x")
                    tempFlag.push(flag[i][i].avatar);
                    if(element.line=="x=0")
                    tempFlag.push(flag[i][0].avatar);
                    if(element.line=="x=1")
                    tempFlag.push(flag[i][1].avatar);
                    if(element.line=="x=2")
                    tempFlag.push(flag[i][2].avatar);
                    if(element.line=="y=0")
                    tempFlag.push(flag[0][i].avatar);
                    if(element.line=="y=1")
                    tempFlag.push(flag[1][i].avatar);
                    if(element.line=="y=2")
                    tempFlag.push(flag[2][i].avatar);
                    if(element.line=="y=-x+2")
                    tempFlag.push(flag[-i+2][i].avatar);
                }
                console.log(tempFlag,allEqual(tempFlag));
                if(allEqual(tempFlag))
                {
                    canvas.style.zIndex="3";
                    console.log(element);
                    valid=1;
                    element.success=1;
                    ctx.beginPath();
                    ctx.strokeStyle="white";
                    ctx.moveTo(element.x1,element.y1);
                    ctx.lineTo(element.x2,element.y2);
                    ctx.stroke();
                    return;
                }
            });
            if(valid)
            return 1;
            else
            return 0;
        }

        function show(x,y,pos) {
            if (flag[y][x].status == 0) {
                if (turn == 1) {
                    document.getElementById("player").innerHTML = "Player 2 Turn";
                } else {
                    document.getElementById("player").innerHTML = "Player 1 Turn";
                }
                document.querySelectorAll(".block")[pos].innerHTML = `<img src='${avatar}'>`;
                flag[y][x].status = 1;
                flag[y][x].avatar = turn;
                if(checkMove(x,y,turn))
                return alert("Victory by Player "+turn);
                if (turn == 1) {
                    turn = 2;
                    avatar = "063-batman.png";
                } else {
                    turn = 1;
                    avatar = "066-Spiderman.png";
                }
            }
        }
    </script>
</body>

</html>